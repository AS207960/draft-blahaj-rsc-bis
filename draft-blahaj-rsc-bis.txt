



SIDR Operations                                           Q. Misell, Ed.
Internet-Draft                                                  AS207960
Updates: 9323 (if approved)                             12 December 2024
Intended status: Standards Track                                        
Expires: 15 June 2025


                RPKI Signed Checklists (RSCs) Version 2
                      draft-blahaj-rsc-bis-latest

Abstract

   This document defines an update to [RFC9323] to include an explicit
   purpose and audience for RSCs.  This alleviates possible security
   vulnerabilities in the original RSC specification caused by cross-
   protocol attacks.

Discussion

   This note is to be removed before publishing as an RFC.

   Source for this draft and an issue tracker can be found at
   https://github.com/AS207960/draft-blahaj-rsc-bis.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 15 June 2025.

Copyright Notice

   Copyright (c) 2024 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
     1.1.  Requirements Language
   2.  Motivation for update
   3.  Updates to RSCs
   4.  IANA Considerations
   5.  References
     5.1.  Normative References
     5.2.  Informative References
   Author's Address

1.  Introduction

   The current version of RPKI Signed Checklists [RFC9323] does not
   signal the purpose of an RSC, nor its intended audience.  In the
   context of processing by humans this is of little concern as the
   context in which e.g. a signed PDF was sent makes its purpose
   evident.  However, in automated machine-to-machine protocols these
   ambiguities can lead to security vulnerabilities.  This document
   updates RSCs to include this information to make them suitable for
   automated processing.

1.1.  Requirements Language

   The key words MUST, MUST NOT, REQUIRED, SHALL, SHALL NOT, SHOULD,
   SHOULD NOT, RECOMMENDED, NOT RECOMMENDED, MAY, and OPTIONAL in this
   document are to be interpreted as described in [BCP14] (RFC2119,
   RFC8174) when, and only when, they appear in all capitals, as shown
   here.

2.  Motivation for update

   Protocols can assign the different meanings to the same data.  In the
   context of human-to-human communication the worst outcome of this is
   often a mere opportunity for a pun; however in the context of
   automated machine-to-machine processing this can lead to serious
   security vulnerabilities.

   An RSC with ambiguous content could, for example, be used in a replay
   attack.  One might argue that a protocol which is vulnerable to such
   a replay attack is a poorly designed one; a counter-argument to this
   is that it should not be possible to design such a vulnerability into
   a protocol built on top of RSCs.

   Further motivation for avoiding such ambiguity in protocols can be
   found in Is that ASCII or is it Protobuf?  The importance of types in
   cryptographic signatures..

3.  Updates to RSCs

   [RFC9323] defines version 0 RSCs; this document defines version 1
   RSCs with the following modifications.

   The RpkiSignedChecklist sequence is updated to the following:

   RpkiSignedChecklist ::= SEQUENCE {
     version [1]           INTEGER DEFAULT 0,
     resources             ResourceBlock,
     digestAlgorithm       DigestAlgorithmIdentifier,
     checkList             SEQUENCE (SIZE(1..MAX)) OF FileNameAndHash
     purpose               OBJECT IDENTIFIER
     audience              OBJECT IDENTIFIER OPTIONAL }

   Two new fields are defined:

   purpose  An OID indicating for which purpose this RSC was created.
      An OID is chosen to avoid potential clashes and to allow for easy
      private extensibility.

   audience  An OID indication for whom the RSC was created.  It MUST be
      set unless otherwise explicitly allowed for by the RSCs purpose,
      e.g. an RSC intended for general widespread consumption.

   RSCs with version 0 are still valid, and may still be used, but MUST
   NOT be used in the context of automated processing.

4.  IANA Considerations

   This document contains no IANA considerations

5.  References

5.1.  Normative References

   [BCP14]    Best Current Practice 14,
              <https://www.rfc-editor.org/info/bcp14>.
              At the time of writing, this BCP comprises the following:

              Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

              Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC9323]  Snijders, J., Harrison, T., and B. Maddison, "A Profile
              for RPKI Signed Checklists (RSCs)", RFC 9323,
              DOI 10.17487/RFC9323, November 2022,
              <https://www.rfc-editor.org/info/rfc9323>.

5.2.  Informative References

   [ascii-or-protobuf]
              Varda, K., "Is that ASCII or is it Protobuf? The
              importance of types in cryptographic signatures.", May
              2015, <https://sandstorm.io/news/2015-05-01-is-that-ascii-
              or-protobuf>.

Author's Address

   Q Misell (editor)
   AS207960 Cyfyngedig
   13 Pen-y-lan Terrace
   Caerdydd
   CF23 9EU
   United Kingdom
   Email: q@as207960.net, q@magicalcodewit.ch
   URI:   https://magicalcodewit.ch
